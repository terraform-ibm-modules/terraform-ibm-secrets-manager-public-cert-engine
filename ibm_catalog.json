{
  "products": [
    {
      "name": "deploy-arch-secrets-manager-public-cert-engine",
      "label": "Cloud automation for Secrets Manager public certificates engine",
      "product_kind": "solution",
      "tags": [
        "ibm_created",
        "target_terraform",
        "terraform",
        "solution",
        "security",
        "platform_engineering"
      ],
      "keywords": [
        "Public certificates engine",
        "Secrets Manager",
        "IaC",
        "infrastructure as code",
        "terraform",
        "solution"
      ],
      "short_description": "Creates and configures a Secrets Manager public certificates engine",
      "long_description": "This deployable architecture sets up a public certificates engine in IBM Cloud Secrets Manager, enabling automated provisioning and management of publicly trusted Transport Layer Security (TLS) certificates. These certificates are issued by Let’s Encrypt, a widely trusted Certificate Authority (CA) that helps secure websites and applications with HTTPS. This deployable architecture configures integration between IBM Cloud Secrets Manager, Cloud Internet Services (CIS) for Domain Name System (DNS) validation, and Let’s Encrypt as the Certificate Authority (CA). It provisions the required authorization policies, DNS configuration, and CA configuration so that applications can obtain and renew public certificates automatically.\n\nℹ️ This Terraform-based automation is part of a broader suite of IBM-maintained Infrastructure as Code (IaC) assets, each following the naming pattern \"Cloud automation for *servicename*\" and focusing on single IBM Cloud service. These single-service deployable architectures can be used on their own to streamline and automate service deployments through an [IaC approach](https://cloud.ibm.com/docs/secure-enterprise?topic=secure-enterprise-understanding-projects), or assembled together into a broader [automated IaC stack](https://cloud.ibm.com/docs/secure-enterprise?topic=secure-enterprise-config-stack) to automate the deployment of an end-to-end solution architecture.",
      "offering_docs_url": "https://github.com/terraform-ibm-modules/terraform-ibm-secrets-manager-public-cert-engine/blob/main/README.md",
      "offering_icon_url": "https://raw.githubusercontent.com/terraform-ibm-modules/terraform-ibm-secrets-manager-public-cert-engine/main/images/secrets_manager_public_cert_engine.svg",
      "provider_name": "IBM",
      "features": [
        {
          "title": "DNS configuration in Internet Services",
          "description": "Adds DNS configuration in Internet Services for domain validation when ordering certificates. [Learn more](https://cloud.ibm.com/docs/secrets-manager?topic=secrets-manager-add-dns-provider&interface=ui)."
        },
        {
          "title": "Service-to-Service Authorization",
          "description": "Creates [authorization](https://cloud.ibm.com/docs/secrets-manager?topic=secrets-manager-prepare-order-certificates#authorize-cis) between the Secrets Manager and Internet Services."
        },
        {
          "title": "Certificate Authority",
          "description": "Configures Let's Encrypt certificate authority for getting the SSL/TLS certificates approved. [Learn more](https://cloud.ibm.com/docs/secrets-manager?topic=secrets-manager-add-certificate-authority&interface=terraform)."
        }
      ],
      "support_details": "This product is in the community registry, as such support is handled through the [original repo](https://github.com/terraform-ibm-modules/terraform-ibm-secrets-manager-public-cert-engine). If you experience issues please open an issue [here](https://github.com/terraform-ibm-modules/terraform-ibm-secrets-manager-public-cert-engine/issues). Please note this product is not supported via the IBM Cloud Support Center.",
      "flavors": [
        {
          "label": "Fully configurable",
          "name": "fully-configurable",
          "index": 1,
          "install_type": "fullstack",
          "working_directory": "solutions/fully-configurable",
          "architecture": {
            "features": [
              {
                "title": " ",
                "description": "Configured to use IBM secure-by-default standards, but can be edited to fit your use case."
              }
            ],
            "diagrams": [
              {
                "diagram": {
                  "caption": "Secrets Manager Public Certificates Engine",
                  "url": "https://raw.githubusercontent.com/terraform-ibm-modules/terraform-ibm-secrets-manager-public-cert-engine/main/reference-architectures/deployable-architecture-sm-public-cert-engine.svg",
                  "type": "image/svg+xml"
                },
                "description": "This architecture supports creating a Secrets Manager public certificates engine within a Secrets Manager instance. The Secrets Manager public certificates engine enables you to issue and manage publicly trusted TLS/SSL certificates by integrating with external Certificate Authorities such as Let's Encrypt. It supports configuring DNS providers like IBM Cloud Internet Services (CIS) for domain validation, managing CA configurations, and automating the issuance and renewal of public certificates for internet-facing applications and services."
              }
            ]
          },
          "iam_permissions": [
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "service_name": "iam-groups",
              "notes": "[Optional] Required for managing IAM access groups."
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::role:Viewer"
              ],
              "service_name": "Resource group only",
              "notes": "Viewer access is required in the resource group you want to provision in."
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::role:Editor",
                "crn:v1:bluemix:public:iam::::serviceRole:Manager"
              ],
              "service_name": "secrets-manager",
              "notes": "Required to create a Secrets Manager instance."
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Manager",
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "service_name": "event-notifications",
              "notes": "[Optional] Required to create an Event Notifications instance."
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Manager",
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "service_name": "sysdig-monitor",
              "notes": "[Optional] Required to create an instance of Cloud Monitoring."
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Writer",
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "service_name": "atracker",
              "notes": "[Optional] Required when enabling the Activity Tracker Event Routing."
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Manager",
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "service_name": "cloud-object-storage",
              "notes": "[Optional] Required to create Object Storage instance."
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Manager",
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "service_name": "logs",
              "notes": "[Optional] Required to create an instance of Cloud Logs."
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Manager",
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "service_name": "hs-crypto",
              "notes": "[Optional] Required if Hyper Protect Crypto Service is used for encryption."
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Manager",
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "service_name": "kms",
              "notes": "[Optional] Required if Key Protect is used for encryption."
            }
          ],
          "configuration": [
            {
              "key": "ibmcloud_api_key"
            },
            {
              "key": "existing_secrets_manager_crn",
              "required": true,
              "value_constraints": [
                {
                  "type": "regex",
                  "description": "The value provided for 'existing_secrets_manager_crn' is not valid.",
                  "value": "^crn:(v\\d:(.*:){2}secrets-manager:(.*:)([aos]\\/[\\w_\\-]+):[0-9a-fA-F]{8}(?:-[0-9a-fA-F]{4}){3}-[0-9a-fA-F]{12}::$"
                }
              ]
            },
            {
              "key": "prefix",
              "required": true,
              "default_value": "dev",
              "random_string": {
                "length": 4
              },
              "value_constraints": [
                {
                  "type": "regex",
                  "description": "Prefix must begin with a lowercase letter and may contain only lowercase letters, digits, and hyphens '-'. It must not end with a hyphen('-'), and cannot contain consecutive hyphens ('--'). It should not exceed 16 characters.",
                  "value": "^$|^__NULL__$|^[a-z](?!.*--)(?:[a-z0-9-]{0,14}[a-z0-9])?$"
                }
              ]
            },
            {
              "key": "existing_resource_group_name",
              "display_name": "resource_group",
              "custom_config": {
                "type": "resource_group",
                "grouping": "deployment",
                "original_grouping": "deployment",
                "config_constraints": {
                  "identifier": "rg_name"
                }
              },
              "default_value": "Default",
              "description": "The name of an existing resource group to provision the resources. [Learn more](https://cloud.ibm.com/docs/account?topic=account-rgs&interface=ui#create_rgs) about how to create a resource group.",
              "virtual": true
            },
            {
              "key": "secrets_manager_region",
              "required": true,
              "virtual": true,
              "default_value": "us-south",
              "description": "The region to provision a Secrets Manager instance.",
              "options": [
                {
                  "displayname": "Osaka (jp-osa)",
                  "value": "jp-osa"
                },
                {
                  "displayname": "Sydney (au-syd)",
                  "value": "au-syd"
                },
                {
                  "displayname": "Tokyo (jp-tok)",
                  "value": "jp-tok"
                },
                {
                  "displayname": "Frankfurt (eu-de)",
                  "value": "eu-de"
                },
                {
                  "displayname": "London (eu-gb)",
                  "value": "eu-gb"
                },
                {
                  "displayname": "Madrid (eu-es)",
                  "value": "eu-es"
                },
                {
                  "displayname": "Dallas (us-south)",
                  "value": "us-south"
                },
                {
                  "displayname": "Montreal (ca-mon)",
                  "value": "ca-mon"
                },
                {
                  "displayname": "Toronto (ca-tor)",
                  "value": "ca-tor"
                },
                {
                  "displayname": "Washington DC (us-east)",
                  "value": "us-east"
                },
                {
                  "displayname": "Sao Paulo (br-sao)",
                  "value": "br-sao"
                }
              ]
            },
            {
              "key": "secrets_manager_service_plan",
              "required": true,
              "virtual": true,
              "type": "string",
              "options": [
                {
                  "displayname": "Standard",
                  "value": "standard"
                },
                {
                  "displayname": "Trial",
                  "value": "trial"
                }
              ],
              "default_value": "standard",
              "description": "The pricing plan to use when provisioning a Secrets Manager instance. Possible values: `standard`, `trial`. You can create only one Trial instance of Secrets Manager per account. Before you can create a new Trial instance, you must delete the existing Trial instance and its reclamation. [Learn more](https://cloud.ibm.com/docs/secrets-manager?topic=secrets-manager-create-instance&interface=ui#upgrade-instance-standard)."
            },
            {
              "key": "service_endpoints",
              "hidden": true
            },
            {
              "key": "ibmcloud_cis_api_key"
            },
            {
              "key": "internet_services_crn",
              "value_constraints": [
                {
                  "type": "regex",
                  "description": "The value provided for 'internet_services_crn' is not valid.",
                  "value": "^__NULL__$|^crn:(v\\d:(.*:){2}internet-svcs:(.*:)([aos]\\/[\\w_\\-]+):[0-9a-fA-F]{8}(?:-[0-9a-fA-F]{4}){3}-[0-9a-fA-F]{12}::$"
                }
              ]
            },
            {
              "key": "internet_services_account_id"
            },
            {
              "key": "internet_service_domain_id"
            },
            {
              "key": "dns_config_name"
            },
            {
              "key": "ca_config_name"
            },
            {
              "key": "lets_encrypt_environment",
              "options": [
                {
                  "displayname": "staging",
                  "value": "staging"
                },
                {
                  "displayname": "production",
                  "value": "production"
                }
              ]
            },
            {
              "key": "acme_letsencrypt_private_key",
              "required": true
            },
            {
              "key": "acme_letsencrypt_private_key_secrets_manager_secret_crn",
              "value_constraints": [
                {
                  "type": "regex",
                  "description": "The value provided for 'acme_letsencrypt_private_key_secrets_manager_secret_crn' is not valid.",
                  "value": "^__NULL__$|^crn:v\\d:(.*:){2}secrets-manager:(.*:)([aos]\\/[\\w_\\-]+):[0-9a-fA-F]{8}(?:-[0-9a-fA-F]{4}){3}-[0-9a-fA-F]{12}:secret:[0-9a-fA-F]{8}(?:-[0-9a-fA-F]{4}){3}-[0-9a-fA-F]{12}$"
                }
              ]
            },
            {
              "key": "skip_iam_authorization_policy"
            },
            {
              "key": "provider_visibility",
              "options": [
                {
                  "displayname": "private",
                  "value": "private"
                },
                {
                  "displayname": "public",
                  "value": "public"
                },
                {
                  "displayname": "public-and-private",
                  "value": "public-and-private"
                }
              ],
              "hidden": true
            }
          ],
          "dependencies": [
            {
              "name": "deploy-arch-ibm-secrets-manager",
              "description": "Configure Secrets Manager to deploy public certificates engine.",
              "id": "6d6ebc76-7bbd-42f5-8bc7-78f4fabd5944-global",
              "version": "v2.11.6",
              "flavors": [
                "fully-configurable"
              ],
              "catalog_id": "7a4d68b4-cf8b-40cd-a3d1-f49aff526eb3",
              "optional": true,
              "on_by_default": true,
              "input_mapping": [
                {
                  "dependency_input": "prefix",
                  "version_input": "prefix",
                  "reference_version": true
                },
                {
                  "dependency_input": "existing_resource_group_name",
                  "version_input": "existing_resource_group_name",
                  "reference_version": true
                },
                {
                  "dependency_input": "region",
                  "version_input": "secrets_manager_region",
                  "reference_version": true
                },
                {
                  "dependency_input": "service_plan",
                  "version_input": "secrets_manager_service_plan",
                  "reference_version": true
                },
                {
                  "dependency_output": "secrets_manager_crn",
                  "version_input": "existing_secrets_manager_crn"
                }
              ]
            }
          ],
          "dependency_version_2": true,
          "terraform_version": "1.12.2",
          "ignore_readme": true
        }
      ]
    }
  ]
}
